import{f as b,a as h,c as Y}from"./D5utmpKv.js";import{o as se}from"./DQlnYJg7.js";import{H as ie,I as le,J as de,K as H,L as R,p as Z,s as k,t as q,a as $,c,r as d,B as ee,h as l,D as I,M as ne}from"./Oh1DGDXX.js";import{d as ae,s as D}from"./BlpmaeCE.js";import{B as ce,p as te,i as L,a as ve,s as fe}from"./CfGrZS5K.js";import{q as ue,v as me,a as he,w as _e,f as O,s as U,k as V,m as W,r as ge,x as ye}from"./DtvwsFTp.js";function J(t,e,...s){var m=new ce(t);ie(()=>{const i=e()??null;m.ensure(i,i&&(n=>i(n,...s)))},le)}const P=H([]),w=H([]),X=H(!1);de(P,t=>{const e={};for(const s of t)e[s.provider]||(e[s.provider]=[]),e[s.provider].push(s);return e});async function be(){X.set(!0);try{const t=await ue();P.set(t)}catch{P.set([])}finally{X.set(!1)}}async function Me(){try{const t=await _e();if(t.selected_models)try{const e=JSON.parse(t.selected_models);Array.isArray(e)&&w.set(e)}catch{w.set([])}}catch{w.set([])}}async function ke(){try{const t=R(w);await me(t)}catch{he("Error saving model selection")}}function we(){const t=R(P),e=R(w),s=new Set(t.map(i=>`${i.provider}:${i.id}`)),m=e.filter(i=>s.has(`${i.provider}:${i.modelId}`));return m.length!==e.length?(w.set(m),!0):!1}async function je(){await Promise.all([be(),Me()]),we()&&await ke()}var pe=b('<div class="modal-footer"><!></div>'),xe=b('<div><div><div class="modal-header"><div class="modal-title-group"><h2> </h2> <!></div> <button class="modal-close" aria-label="Close" data-testid="modal-close"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div> <div class="modal-body"><!></div> <!></div></div>');function Fe(t,e){Z(e,!0);let s=te(e,"wide",3,!1);function m(r){r.key==="Escape"&&e.open&&e.onclose()}function i(r){r.target===r.currentTarget&&e.onclose()}se(()=>(document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)));var n=xe();let p;n.__click=i;var x=c(n);let S;var E=c(x),g=c(E),C=c(g),N=c(C,!0);d(C);var K=k(C,2);{var a=r=>{var v=Y(),y=ee(v);J(y,()=>e.titleBadge),h(r,v)};L(K,r=>{e.titleBadge&&r(a)})}d(g);var o=k(g,2);o.__click=function(...r){var v;(v=e.onclose)==null||v.apply(this,r)},d(E);var u=k(E,2),M=c(u);J(M,()=>e.children),d(u);var j=k(u,2);{var T=r=>{var v=pe(),y=c(v);J(y,()=>e.footer),d(v),h(r,v)};L(j,r=>{e.footer&&r(T)})}d(x),d(n),q(()=>{O(n,"id",e.id),p=U(n,1,"modal-overlay",null,p,{active:e.open}),S=U(x,1,"modal",null,S,{"modal-wide":s()}),D(N,e.title)}),h(t,n),$()}ae(["click"]);var Se=b('<div class="no-models">No models available. Configure API keys first.</div>'),Ee=b("<h4> </h4>"),Ce=b('<label class="model-checkbox"><input/> <span class="model-name"> </span></label>'),Ae=b('<div class="model-provider-group"><!> <div class="model-list"></div></div>'),Be=b('<div class="model-selection-container"><!></div>');function Ie(t,e){Z(e,!0);const s=()=>fe(P,"$availableModels",m),[m,i]=ve();let n=te(e,"mode",3,"checkbox");const p=I(()=>e.filterProvider?s().filter(a=>a.provider===e.filterProvider):s()),x=I(()=>()=>{const a={};for(const o of l(p))a[o.provider]||(a[o.provider]=[]),a[o.provider].push(o);return a});function S(a,o){return e.selectedModels.some(u=>u.provider===a&&u.modelId===o)}function E(a,o,u){n()==="radio"?e.onchange([{provider:a,modelId:o}]):u?S(a,o)||e.onchange([...e.selectedModels,{provider:a,modelId:o}]):e.onchange(e.selectedModels.filter(M=>!(M.provider===a&&M.modelId===o)))}var g=Be(),C=c(g);{var N=a=>{var o=Se();h(a,o)},K=a=>{var o=Y(),u=ee(o);V(u,17,()=>Object.entries(l(x)()),W,(M,j)=>{var T=I(()=>ne(l(j),2));let r=()=>l(T)[0],v=()=>l(T)[1];var y=Ae(),z=c(y);{var oe=A=>{var f=Ee(),B=c(f,!0);d(f),q(()=>D(B,r())),h(A,f)};L(z,A=>{e.filterProvider||A(oe)})}var G=k(z,2);V(G,21,v,W,(A,f)=>{var B=Ce(),_=c(B);ge(_),_.__change=F=>E(l(f).provider,l(f).id,F.target.checked);var Q=k(_,2),re=c(Q,!0);d(Q),d(B),q(F=>{O(_,"type",n()),O(_,"name",n()==="radio"?"model-selection":void 0),ye(_,F),O(_,"data-provider",l(f).provider),O(_,"data-model-id",l(f).id),D(re,l(f).name)},[()=>S(l(f).provider,l(f).id)]),h(A,B)}),d(G),d(y),h(M,y)}),h(a,o)};L(C,a=>{l(p).length===0?a(N):a(K,!1)})}d(g),h(t,g),$(),i()}ae(["change"]);export{Fe as M,Ie as a,ke as b,P as c,J as d,je as i,be as l,w as s};
